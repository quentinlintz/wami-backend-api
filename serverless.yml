service: wami-backend-api
frameworkVersion: '3'

provider:
  name: aws
  runtime: nodejs14.x
  memorySize: 256
  stage: ${opt:stage, 'dev'}
  region: us-east-2
  environment:
    CHALLENGES_TABLE_NAME: ${self:custom.ChallengesTable.name}
  iamRoleStatements:
    - ${file(iam/ChallengesTableIAM.yml):ChallengesTableIAM}

resources:
  Resources:
    ChallengesTable: ${file(resources/ChallengesTable.yml):ChallengesTable}

functions:
  today:
    handler: src/functions/challenges/today.handler
    events:
      - http:
          path: today
          method: get
  new:
    handler: src/functions/challenges/new.handler
    events:
      - http:
          path: new
          method: post

custom:
  ChallengesTable:
    name: !Ref ChallengesTable
    arn: !GetAtt ChallengesTable.Arn
